# My Theme

A modern Drupal 11 theme built with **Single Directory Components (SDC)** and powered by Webpack for efficient asset compilation.

## Overview

This theme is designed to work seamlessly with Drupal's **Single Directory Components** system, allowing you to build reusable, self-contained components with their own templates, styles, and JavaScript.

### Key Features

- âœ… **SDC Ready**: Fully compatible with Drupal's Single Directory Components
- ğŸ¨ **SCSS Support**: Modern CSS preprocessing with Sass
- âš¡ **ES6+ JavaScript**: Modern JavaScript with Babel transpilation
- ğŸ” **Code Quality**: Integrated ESLint and Stylelint for code consistency
- ğŸ¯ **SVG Sprite Generation**: Automatic SVG sprite compilation for icons
- ğŸ“Š **Build Stats**: Detailed build performance metrics with WebpackBar
- ğŸ”„ **Watch Mode**: Live compilation during development

## Project Structure

```
mytheme/
â”œâ”€â”€ components/          # SDC components (atoms, molecules, organisms)
â”‚   â”œâ”€â”€ atoms/          # Smallest reusable components
â”‚   â”œâ”€â”€ molecules/      # Combined atomic components
â”‚   â””â”€â”€ organisms/      # Complex component compositions
â”œâ”€â”€ images/
â”‚   â””â”€â”€ icons/          # SVG icons for sprite generation
â”œâ”€â”€ webpack/            # Webpack configuration files
â”‚   â”œâ”€â”€ webpack.common.js  # Shared webpack config
â”‚   â”œâ”€â”€ webpack.dev.js     # Development config
â”‚   â””â”€â”€ webpack.prod.js    # Production config
â”œâ”€â”€ mytheme.info.yml    # Drupal theme info
â””â”€â”€ package.json        # Node dependencies and scripts
```

## Single Directory Components (SDC)

Each component follows the SDC pattern with this structure:

```
components/[type]/[component-name]/
â”œâ”€â”€ [component-name].component.yml  # Component definition
â”œâ”€â”€ [component-name].twig           # Twig template
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ [component-name].js        # Component JavaScript
â”‚   â””â”€â”€ [component-name].scss      # Component styles
â””â”€â”€ [component-name].js            # Compiled JavaScript (auto-generated)
â””â”€â”€ [component-name].css           # Compiled CSS (auto-generated)
```

### Example Component Structure

```
components/molecules/button/
â”œâ”€â”€ button.component.yml
â”œâ”€â”€ button.twig
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ button.js
â”‚   â””â”€â”€ button.scss
â”œâ”€â”€ button.js     # â† Generated by Webpack
â””â”€â”€ button.css    # â† Generated by Webpack
```

## What Webpack Does

Webpack handles all asset compilation and optimization for this theme:

### JavaScript Processing
- **Transpilation**: Converts modern ES6+ JavaScript to browser-compatible ES5
- **Polyfills**: Automatically includes necessary polyfills via `core-js`
- **Code Quality**: Runs ESLint to catch errors and enforce code standards
- **Source Maps**: Generates source maps in development mode for debugging

### SCSS/CSS Processing
- **Compilation**: Converts SCSS to standard CSS
- **Auto-prefixing**: Adds vendor prefixes for browser compatibility
- **Extraction**: Separates CSS into individual files matching component structure
- **Linting**: Validates SCSS code with Stylelint

### SVG Sprite Generation
- **Auto-Discovery**: Finds all SVG files in `images/icons/`
- **Sprite Creation**: Combines them into a single `icons-sprite.svg` file
- **Symbol IDs**: Prefixes each icon with `icon-` (e.g., `icon-home`)
- **No JS Output**: Generates only the SVG sprite (no unnecessary JavaScript)

### File Organization
- **Dynamic Entry Points**: Automatically discovers all `.js` and `.scss` files in `components/**/src/`
- **Folder Structure**: Maintains the same directory structure in output
- **Clean Output**: Only generates necessary files (no build artifacts in version control)

## NPM Commands

### Development

```bash
npm start
```

**What it does:**
- Runs Webpack in **watch mode**
- Automatically recompiles when files change
- Generates **source maps** for easier debugging
- Outputs unminified code for development

**Use this when:** You're actively developing and want instant feedback on changes.

---

### Production Build

```bash
npm run build:prod
```

**What it does:**
- Runs Webpack in **production mode**
- **Minifies** JavaScript and CSS for optimal file size
- Runs **ESLint** and **Stylelint** validation
- Shows **build statistics** and performance metrics
- Generates optimized assets for deployment
- No source maps (smaller file sizes)

**Use this when:** You're ready to deploy or want to test production-optimized code.

**Output includes:**
- âœ” Compilation status for each build stage
- ğŸ“Š Profile statistics (build time by file type and loader)
- âš ï¸ Warnings and errors from linters

---

## Getting Started

### 1. Install Dependencies

```bash
npm install
```

### 2. Start Development

```bash
npm start
```

This will watch for changes and automatically recompile your assets.

### 3. Build for Production

```bash
npm run build:prod
```

This creates optimized, production-ready assets.

---

## Using SVG Icons

Place your SVG files in `images/icons/` and they'll be automatically compiled into a sprite:

### Adding an Icon

1. Add your SVG file: `images/icons/my-icon.svg`
2. Build will generate: `images/icons-sprite.svg`
3. Use in templates:

```twig
<svg class="icon">
  <use xlink:href="{{ base_path ~ directory }}/images/icons-sprite.svg#icon-my-icon"></use>
</svg>
```

---

## Code Quality Tools

### ESLint (JavaScript)
- **Config**: `eslint.config.js`
- **Rules**: Based on recommended standards + Prettier integration
- Runs automatically during builds
- Reports warnings for issues like unused variables

### Stylelint (SCSS/CSS)
- **Config**: `.stylelintrc.json`
- **Rules**: Based on `stylelint-config-standard`
- Validates hex colors, duplicate properties, unknown units
- Enforces consistent formatting

### Prettier (Code Formatting)
- Integrated with ESLint for consistent formatting
- Ensures code style consistency across the project

---

## Browser Support

JavaScript targets modern browsers via Babel:
- `> 0.25%` market share
- Not dead browsers
- Automatic polyfills for required features

---

## Development Tips

### Component Best Practices

1. **Keep components atomic**: Each component should do one thing well
2. **Use the SDC structure**: Follow the component.yml â†’ twig â†’ src pattern
3. **Scope your styles**: Use BEM or component-scoped class names
4. **Document props**: Define all component properties in `*.component.yml`

### Watching for Issues

- Monitor the terminal output during `npm start`
- ESLint warnings appear immediately when you save
- Stylelint errors will stop the build if critical

### Performance

- Use `npm run build:prod` to see build stats
- Check "Stats by Loader" to identify slow compilation steps
- Large SCSS files? Consider splitting them into partials

---

## Troubleshooting

### Build Fails
1. Check terminal output for specific errors
2. Verify file syntax (especially SCSS/JS)
3. Run linters manually: `npx eslint .` or `npx stylelint "**/*.scss"`

### Changes Not Appearing
1. Ensure `npm start` is running
2. Check you're editing files in `src/` folders
3. Clear Drupal cache: `drush cr`

### Icons Not Showing
1. Verify SVG is in `images/icons/`
2. Check `images/icons-sprite.svg` was generated
3. Confirm the symbol ID matches your filename (prefixed with `icon-`)

---

## Tech Stack

- **Drupal**: 11.2+
- **Webpack**: 5.102+
- **Babel**: 7.28+ (ES6+ transpilation)
- **Sass**: 1.93+ (SCSS compilation)
- **ESLint**: 9.39+ (JavaScript linting)
- **Stylelint**: 16.25+ (CSS/SCSS linting)
- **WebpackBar**: 7.0+ (Build progress reporting)

---

## License

ISC

---

## Contributing

When adding new components:
1. Follow the SDC structure
2. Include all required files (`.component.yml`, `.twig`, source files)
3. Test in both development and production modes
4. Ensure code passes linting (no errors)
